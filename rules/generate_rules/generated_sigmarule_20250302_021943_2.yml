title: Obfuscated CertUtil Command-Line Execution
id: f6e5d4c3-b2a1-0987-6fed-cba987654321
description: Detects the execution of certutil.exe with obfuscated command-line arguments that may indicate an attempt to evade detection while downloading or decoding malicious files.
author: Yusuke Nakajima
date: 2025-03-02
tags:
  - attack.execution
  - attack.defense_evasion
  - attack.t1202
logsource:
  product: windows
  category: process_creation
detection:
  selection_obfuscated_certutil:
    Image|endswith:
      - '\\certutil.exe'
      - '\\CertUtil.exe'
    OriginalFileName:
      - 'certutil.exe'
      - 'CertUtil.exe'
    CommandLine|re:
      - '(?i)\\bcertutil\\b.*\/urlcache.*https?:\/\/[a-zA-Z0-9\-\.]+\/[a-zA-Z0-9\-\.]+'
      - '(?i)\\bcertutil\\b.*\/decode.*https?:\/\/[a-zA-Z0-9\-\.]+\/[a-zA-Z0-9\-\.]+'
      - '(?i)\\bcertutil\\b.*\/f .*https?:\/\/[a-zA-Z0-9\-\.]+\/[a-zA-Z0-9\-\.]+'
  condition: selection_obfuscated_certutil
falsepositives:
  - Legitimate usage of certutil with encoded URLs by system administrators
level: high
