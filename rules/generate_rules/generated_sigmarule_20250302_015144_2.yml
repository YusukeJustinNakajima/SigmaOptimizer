title: Suspicious 'whoami.exe' Execution with Minimal or Obfuscated Arguments
id: f1e2d3c4-b5a6-7890-cdef-1234567890ab
status: test
description: Detects execution of 'whoami.exe' with minimal or obfuscated arguments, potentially used for user enumeration in malicious activities.
author: Yusuke Nakajima
date: 2025-03-02
tags:
  - attack.discovery
  - attack.execution
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    EventID: 4688
    Image|endswith:
      - '\\whoami.exe'
    CommandLine|re:
      - '(?i)^whoami$'
      - '(?i)^whoami\s*/user$'
      - '(?i)^whoami\s+\-u$'
      - '(?i)^whoami[^\w]*u[^\w]*s[^\w]*e[^\w]*r$'
  condition: selection
falsepositives:
  - Legitimate use of 'whoami.exe' with minimal arguments for system diagnostics.
level: medium
