title: Obfuscated CertUtil.exe Command with Remote URL
id: f1e2d3c4-b5a6-0987-fedc-6543210fedcb
description: Detects the execution of certutil.exe with obscured command lines attempting to download files from remote servers, potentially bypassing simple detections.
author: Yusuke Nakajima
date: 2025-03-02
tags:
  - attack.execution
  - attack.defense_evasion
  - attack.t1203
logsource:
  category: process_creation
  product: windows
detection:
  selection_img:
    EventID: 1
    Image|endswith:
      - '\certutil.exe'
  selection_re:
    CommandLine|re:
      - '(?i)certutil.*https?://'
      - '(?i)c[^a-zA-Z0-9]*e[^a-zA-Z0-9]*r[^a-zA-Z0-9]*t[^a-zA-Z0-9]*u[^a-zA-Z0-9]*t[^a-zA-Z0-9]*i[^a-zA-Z0-9]*l.*https?://'
  condition: selection_img and selection_re
falsepositives:
  - Legitimate use of certutil.exe with complex command lines for administrative purposes.
level: high
