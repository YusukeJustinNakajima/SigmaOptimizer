title: Detection of 'whoami' Command Execution with Obfuscated '/user' Argument
id: a1b2c3d4-e5f6-7890-abcd-ef1234567890
description: |
    Detects the execution of the 'whoami' command with the '/user' argument, including common obfuscation techniques.
    This can be used for user enumeration by attackers.
author: Yusuke Nakajima
date: 2025-03-02
tags:
  - attack.execution
  - attack.discovery
logsource:
  category: process_creation
  product: windows
detection:
  selection_security:
    EventID: 4688
    CommandLine|re|all:
      - '(?i)\bwhoami\b.*[/-]["'']?u["'']?s["'']?e["'']?r["'']?'
      - '(?i)\bwhoami\b.*[/-]u[^a-zA-Z0-9\s]*s[^a-zA-Z0-9\s]*e[^a-zA-Z0-9\s]*r'
  condition: selection_security
falsepositives:
  - Legitimate administrative or troubleshooting use of 'whoami /user' command.
level: medium
