title: Malicious Usage of CertUtil to Download Files
id: a1b2c3d4-e5f6-7890-abcd-ef1234567890
description: Detects the execution of certutil.exe with command-line arguments indicative of downloading files, potentially for malicious purposes.
author: Yusuke Nakajima
date: 2025-03-02
tags:
  - attack.execution
  - attack.defense_evasion
  - attack.t1202
logsource:
  product: windows
  category: process_creation
detection:
  selection_certutil:
    Image|endswith:
      - '\\certutil.exe'
      - '\\CertUtil.exe'
    OriginalFileName:
      - 'certutil.exe'
      - 'CertUtil.exe'
    CommandLine|contains:
      - '/urlcache'
      - '/f'
      - '/download'
      - '/decode'
  condition: selection_certutil and CommandLine|contains|all:
    - 'http'
    - '.txt'
falsepositives:
  - Legitimate administrative use of certutil for certificate management
level: high
