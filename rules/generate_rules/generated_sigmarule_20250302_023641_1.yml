title: Suspicious Certutil.exe Download from External URL
id: e3f1a2b4-5c6d-7e8f-9012-3456789abcde
description: |
    Detects the use of certutil.exe to download files from external URLs, potentially indicating data exfiltration or malware download.
    This rule accounts for common obfuscation techniques used to evade detection.
references:
    - https://github.com/Neo23x0/sigma/wiki/Rules-examples#download-with-certutil
    - https://github.com/SwiftOnSecurity/sigma/wiki/Rules-examples#download-with-certutil
author: Yusuke Nakajima
date: 2025-03-02
modified: 2025-03-02
tags:
    - attack.execution
    - attack.download
    - attack.t1140
logsource:
    product: windows
    category: process_creation
detection:
    selection_certutil_download:
        OriginalFileName|icontains: 'certutil.exe'
        CommandLine|re:
            - '(?i)certutil[^a-zA-Z0-9]{0,10}/urlcache[^a-zA-Z0-9]{0,10}https?://'
            - '(?i)certutil[^a-zA-Z0-9]{0,10}/c[^a-zA-Z0-9]{0,10}https?://'
    condition: selection_certutil_download
falsepositives:
    - Legitimate use of certutil.exe for administrative file downloads.
level: high
